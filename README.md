Mountain_passes
# Проект Виртуальной стажировки по разработке мобильного приложения для Федерация Спортивного Туризма России (далее ФСТР).

## С какой проблемой к нам обратился заказчик:

На сайте ФСТР ведётся база горных перевалов, которая пополняется туристами. После преодоления очередного перевала, турист заполняет отчёт в формате PDF и отправляет его на электронную почту федерации. Экспертная группа ФСТР получает эту информацию, верифицирует, а затем вносит её в базу, которая ведётся в Google-таблице. Весь процесс очень неудобный и долгий и занимает в среднем от 3 до 6 месяцев.

## Как заказчик хочет решить эту проблему

Разработать мобильное приложение для Android и IOS, которое упростило бы туристам задачу по отправке данных о перевале и сократило время обработки запроса до трёх дней. Пользоваться мобильным приложением будут туристы. В горах они будут вносить данные о перевале в приложение и отправлять их в ФСТР, как только появится доступ в Интернет. Модератор из федерации будет верифицировать и вносить в базу данных информацию, полученную от пользователей, а те в свою очередь смогут увидеть в мобильном приложении статус модерации и просматривать базу с объектами, внесёнными другими.

### Для пользователя в мобильном приложении будут доступны следующие действия:

- Внесение информации о новом объекте (перевале) в карточку объекта.
- Редактирование в приложении неотправленных на сервер ФСТР данных об объектах. На перевале не всегда работает Интернет.
- Заполнение ФИО и контактных данных (телефон и электронная почта) с последующим их автозаполнением при внесении данных о новых объектах.
- Отправка данных на сервер ФСТР.
- Получение уведомления о статусе отправки (успешно/неуспешно).
- Согласие пользователя с политикой обработки персональных данных в случае нажатия на кнопку «Отправить» при отправке данных на сервер.

### Пользователь с помощью мобильного приложения также будет передавать в ФСТР следующие данные о перевале:

- координаты перевала и его высота;
- имя пользователя;
- почта и телефон пользователя;
- название перевала;
- несколько фотографий перевала.

#### Допустимые значения поля status:

'new' - новая заявка(default-значение);
'pending' — на рассмотрении;
'accepted' — заявка принята;
'rejected' — заявка отклонена.

## Описание методов API

### Метод POST API/submitData/

Этот метод принимает JSON в теле запроса с информацией о перевале.

#### Пример JSON:
{
"beauty_title": "пер.",
"title": "Дятлова",
"other_titles": "седл.",
"connect": "0",
"add_time": "2023-04-15 19:13:14",
"user": {
    "email": "sohuga5656@gmail.com",
    "fam": "Михайлов",
    "name": "Михаил",
    "otc": "Михайлович",
    "phone": "89997777777"
    },
    "coordinates": {
        "latitude": "77.7777",
        "longitude": "11.1111",
        "height": "2727"
    },
    "level": {
        "winter": "2А",
        "summer": "1А*",
        "autumn": "1А",
        "spring": "2A*"
    },
    "images": [
        {
        "data": "image1",
        "title": "Основание"
        },
        {
        "data": "image2",
        "title": "Седло"
        },
        {
        "data": "image3",
        "title": "Обрыв"
        }
    ]
}
Результатом выполнения метода является JSON-ответ содержащий следующие данные: 'status' + код HTTP, целое число:

 200 — запрос успешно обработан;
 400 — Bad Request (при нехватке полей);
 500 — ошибка при выполнении операции.

`message` — строка +
`Success` - если отправлено успешно или `Причина ошибки` - если она была
`id` — идентификатор, который был присвоен объекту при добавлении в базу данных (если "status":200).

#### Примеры JSON-ответов:

{ "status": 200, "message": "Success", "id": 42}
{ "status": 400, "message": "Empty request", "id": null}
{ "status": 500, "message": "Ошибка подключения к базе данных", "id": null}

### Метод GET API/submitData/

Этот метод получает одну запись (перевал) по её id с выведением всей информацию об перевале, в том числе статус модерации.

#### Пример JSON:
{
"id": 7,
"user": {
    "email": "sohuga5656@gmail.com",
    "fam": "Михайлов",
    "name": "Михаил",
    "otc": "Михайлович",
    "phone": "89997777777"
    },
    "coordinates": {
        "id": 1,
        "latitude": 777.77,
        "longitude": 77.77,
        "height": 1111
    },
    "levels": {
        "id": 2,
        "winter": "1С",
        "summer": "1А*",
        "autumn": "1А",
        "spring": "1С*"
    },
    "images": [
        {
        "id": 3,
        "created": "2023-04-15T10:44:29.555124",
        "title": "Основание",
        "data": "",
        "pass": 7
        },
        {
        "id": 4,
        "created": "2023-04-15T10:46:29.777144",
        "title": "Седло",
        "data": "",
        "pass": 7
        }
        ],
    "created": "2023-04-15T10:41:38.631576",
    "beauty_title": "пер.",
    "title": "Дятлова",
    "other_titles": "пере.",
    "connect": "0",
    "add_time": "2023-04-15T19:10:11",
    "status": "new"
}

#### Примеры JSON-ответов:

{ "status": 200, "message": "Success", "id": 42 }
{ "status": 400, "message": "There's no such record", "id": null}

### Метод PATCH API/submitData/

Позволяет отредактировать существующую запись (замена), если она в статусе `new`. При этом редактировать можно все поля, кроме ФИО, адреса почты и номера телефона. В качестве результата изменения приходит ответ содержащий следующие данные:
state:

1 — если успешно удалось отредактировать запись в базе данных.
0 — отредактировать запись не удалось.

message: - сообщение об успешном редактировании при state=1) - сообщение о причине неудачного обновления записи при state=0)

#### Примеры JSON-ответов:

{ "status": 200, "message": "Success", "state": 1 }
{ "status": 400, "message": "It's not a NEW status of the record", "state": 0}

### Метод GET+email API/submitData/?user_email=email

Возвращает данные всех объектов, отправленных на сервер пользователем с почтой email. Пример запроса:

GET API/submitData/?user_email=sohuga5656@gmail.com